# 课后作业习题8

姓名：王骏

学号：22020007104

## 问题1: 假设小刚只看到密文，他能对小明的消息进行密码分析吗？

A. 不能，因为只有小明和小亮知道密钥，且伪随机数生成器生成 0 或 1 的概率相等，小刚无法知道小明消息的内容是什么。

B. 能，因为使用超级计算机，小刚可以尝试密钥K中所有可能的 0 和 1 的组合，以检查它们是否与密文匹配。

C. 不能，因为计算两个比特流的 XOR 很困难。

D.能，因为 XOR 是一个简单的函数，小刚只需计算 XOR 的逆。

**选A**

 A公司使用的系统本质上是一个**一次性密码本（One-Time Pad）**的变种，但使用的是**伪随机数生成器（PRNG）**生成的比特流，而不是真正随机的比特流。

1. **密钥保密性**：题目明确指出，“只有小明和小亮知道密钥K”。小刚作为被动攻击者，只看到了密文，但不知道密钥K。
2. **XOR的特性**：XOR操作的解密需要知道相同的密钥流。即 C=M⊕S，要得到 M，需要计算 C⊕S=(M⊕S)⊕S=M⊕(S⊕S)=M⊕0=M。没有密钥流S，小刚无法解密。
3. **PRNG的安全性**：题目指出，“伪随机数生成器不包含密码学的弱点”，这意味着没有密钥（种子），小刚无法预测或生成相同的比特流。
4. **等概率假设**：尽管消息出现的概率是等可能的，这只是指消息本身没有统计上的冗余，对于没有密钥的小刚来说，这并不意味着他可以推断出消息内容。对于不知道密钥流的攻击者来说，每个密文比特是0或1的概率都是50%，无法从中推断出原始消息比特。

## 问题2: 小明和小亮切换到一个新的共享密钥。小强采取主动攻击，诱使小明发送一个消息，该消息以 500 个 "1" 开始，然后是小明的原始消息。鉴于密文，小强能对小明的消息进行密码分析吗？

A. 能，因为密钥长度小于 500 位。

B. 可能，但概率非常低，可以忽略不计。

C. 不能，因为只有小明和小亮知道密钥，且伪随机数生成器生成 0 或 1 的概率相等，小强 无法提取 Alice 的消息。

D.不能，因为计算两个比特的 XOR 很困难。

 **选A**

加密过程是 Ci=Mi⊕Si，其中 Ci 是密文比特，Mi 是明文比特，Si 是密钥流比特。小强诱使小明发送一个以500个"1"开始的消息。这意味着小强知道了明文的前500个比特 M1,M2,...,M500 都是 '1'。

由于 Si=Mi⊕Ci，小强可以利用已知的明文前500个“1”和对应的密文前500个比特，来推导出伪随机数生成器生成的前500个比特流 S1,S2,...,S500。即 Si=′1′⊕Ci。题目提到共享密钥K是200位的。伪随机数生成器（PRNG）以共享密钥作为种子。如果密钥K的长度是200位，而消息的长度（包括前500个“1”）可能远大于200位，那么PRNG会根据这个200位的种子生成一个**周期性**的比特流。虽然题目没有明确说明PRNG的周期性，但PRNG通常会重复其生成的比特流。如果PRNG生成的比特流的**有效周期**小于500位，那么小强可以根据推导出的前500个密钥流比特，推断出后续的密钥流模式。即使PRNG的周期很长，只要小强获得了比**种子长度**（200位）更长的密钥流，他就有可能通过**PRNG的公开代码**来**逆向推导出种子K**。一旦推导出种子K，小强就可以生成任意长度的密钥流，进而解密小明剩余的原始消息。对于流密码来说，如果攻击者能够获得一部分明文和对应的密文，就可以恢复出密钥流，进而解密其他密文。

## 问题3: 小刚能从消息的内容中推断出什么？

A. 什么都推断不出。

B. 请求的内容，但不包括回复。

C. 请求和回复的 XOR。

D.请求和回复的内容。

**选C**

小明发送请求（M1）：C1=M1⊕SK

小亮发送回复（M2）：C2=M2⊕SK （这里使用了**相同的密钥K作为种子**，因此伪随机数生成器会产生**相同的比特流** SK）

小刚可以看到小明发送的密文 C1 和小亮发送的密文 C2。

小刚可以计算 C1⊕C2。 C1⊕C2=(M1⊕SK)⊕(M2⊕SK) 由于异或操作具有结合律和交换律，并且 SK⊕SK=0，所以： C1⊕C2=M1⊕SK⊕M2⊕SK=M1⊕M2⊕(SK⊕SK)=M1⊕M2⊕0=M1⊕M2

小刚可以得到**请求消息和回复消息的异或结果**。虽然小刚得到了 M1⊕M2，但他无法单独解密出 M1 或 M2，因为他不知道密钥流 SK。